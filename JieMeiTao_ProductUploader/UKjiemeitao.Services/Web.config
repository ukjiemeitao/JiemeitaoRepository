<?xml version="1.0"?>
<configuration>
  <configSections>
    <section name="entityFramework" type="System.Data.Entity.Internal.ConfigFile.EntityFrameworkSection, EntityFramework, Version=4.3.1.0, Culture=neutral, PublicKeyToken=b77a5c561934e089"/>
    <section name="unity" type="Microsoft.Practices.Unity.Configuration.UnityConfigurationSection, Microsoft.Practices.Unity.Configuration"/>
    <section name="log4net" type="log4net.Config.Log4NetConfigurationSectionHandler, log4net"/>
  </configSections>
  <entityFramework>
    <defaultConnectionFactory type="System.Data.Entity.Infrastructure.SqlConnectionFactory, EntityFramework">
      <parameters>
        <parameter value="Server=stma-mac1\sqlexpress;database=Catalog;User ID=publicguest;Password=Welcome1;Integrated Security=false;"/>
      </parameters>
    
    </defaultConnectionFactory>
  </entityFramework>
  <unity xmlns="http://schemas.microsoft.com/practices/2010/unity">
    <sectionExtension type="Microsoft.Practices.Unity.InterceptionExtension.Configuration.InterceptionConfigurationExtension, Microsoft.Practices.Unity.Interception.Configuration"/>
    <container>
      <extension type="Interception"/>
      <register type="UKjiemeitao.Domain.Repositories.IRepositoryContext, UKjiemeitao.Domain"
                mapTo="UKjiemeitao.Domain.Repositories.EntityFramework.EntityFrameworkRepositoryContext, UKjiemeitao.Domain.Repositories">
        <lifetime type="UKjiemeitao.Infrastructure.WcfPerRequestLifetimeManager, UKjiemeitao.Infrastructure"/>
      </register>
      <!--Repository Context & Repositories-->
      <register type="UKjiemeitao.Domain.Repositories.ITBItemCatRepository, UKjiemeitao.Domain" 
                mapTo="UKjiemeitao.Domain.Repositories.TBItemCatRepository, UKjiemeitao.Domain.Repositories"/>
      <register type="UKjiemeitao.Domain.Repositories.ITBItemPropRepository, UKjiemeitao.Domain"
                mapTo="UKjiemeitao.Domain.Repositories.TBItemPropRepository, UKjiemeitao.Domain.Repositories"/>
      <register type="UKjiemeitao.Domain.Repositories.ITBPropValueRepository, UKjiemeitao.Domain"
                mapTo="UKjiemeitao.Domain.Repositories.TBPropValueRepository, UKjiemeitao.Domain.Repositories"/>
      <register type="UKjiemeitao.Domain.Repositories.ITBProductRepository, UKjiemeitao.Domain"
                mapTo="UKjiemeitao.Domain.Repositories.TBProductRepository, UKjiemeitao.Domain.Repositories"/>

      <register type="UKjiemeitao.Domain.Repositories.ISSBrandRepository, UKjiemeitao.Domain"
               mapTo="UKjiemeitao.Domain.Repositories.SSBrandRepository, UKjiemeitao.Domain.Repositories"/>
      <register type="UKjiemeitao.Domain.Repositories.ISSProductRepository, UKjiemeitao.Domain"
                mapTo="UKjiemeitao.Domain.Repositories.SSProductRepository, UKjiemeitao.Domain.Repositories"/>
      <register type="UKjiemeitao.Domain.Repositories.ISSCategoryRepository, UKjiemeitao.Domain"
                mapTo="UKjiemeitao.Domain.Repositories.SSCategoryRepository, UKjiemeitao.Domain.Repositories"/>
      <register type="UKjiemeitao.Domain.Repositories.ISSRetailerRepository, UKjiemeitao.Domain"
                mapTo="UKjiemeitao.Domain.Repositories.SSRetailerRepository, UKjiemeitao.Domain.Repositories"/>
      <register type="UKjiemeitao.Domain.Repositories.ISSSizeRepository, UKjiemeitao.Domain"
                mapTo="UKjiemeitao.Domain.Repositories.SSSizeRepository, UKjiemeitao.Domain.Repositories"/>
      <register type="UKjiemeitao.Domain.Repositories.ISSImageRepository, UKjiemeitao.Domain"
                mapTo="UKjiemeitao.Domain.Repositories.SSImageRepository, UKjiemeitao.Domain.Repositories"/>
      <register type="UKjiemeitao.Domain.Repositories.ISSProductColorImageMappinRepository, UKjiemeitao.Domain"
                mapTo="UKjiemeitao.Domain.Repositories.SSProductColorImageMappinRepository, UKjiemeitao.Domain.Repositories"/>
      <register type="UKjiemeitao.Domain.Repositories.ISSTBBrandMappingRepository, UKjiemeitao.Domain"
                mapTo="UKjiemeitao.Domain.Repositories.SSTBBrandMappingRepository, UKjiemeitao.Domain.Repositories"/>

      <!--Application Service Implementations-->
      <register type="UKjiemeitao.Application.Interface.ITBProductUploadService, UKjiemeitao.Application" 
                mapTo="UKjiemeitao.Application.Implementation.TBProductUploadServiceImpl, UKjiemeitao.Application">
        <interceptor type="InterfaceInterceptor"/>
        <interceptionBehavior type="UKjiemeitao.Infrastructure.InterceptionBehaviors.ExceptionLoggingBehavior, UKjiemeitao.Infrastructure"/>
      </register>
      
      <register type="UKjiemeitao.Application.Interface.IShopStyleService, UKjiemeitao.Application"
                mapTo="UKjiemeitao.Application.Implementation.ShopStyleServiceImpl, UKjiemeitao.Application">
        <interceptor type="InterfaceInterceptor"/>
        <interceptionBehavior type="UKjiemeitao.Infrastructure.InterceptionBehaviors.ExceptionLoggingBehavior, UKjiemeitao.Infrastructure"/>
      </register>
    </container>
  </unity>
  <log4net>
    <appender name="RollingFileAppender" type="log4net.Appender.RollingFileAppender">
      <file value="Logs\syslog.txt"/>
      <appendToFile value="true"/>
      <rollingStyle value="Size"/>
      <maxSizeRollBackups value="10"/>
      <maximumFileSize value="100KB"/>
      <staticLogFileName value="true"/>
      <layout type="log4net.Layout.PatternLayout">
        <param name="ConversionPattern" value="%newline%date [%thread] %-5level %logger - %message%newline"/>
      </layout>
    </appender>
    <logger name="UKjiemeitao.Logger">
      <level value="ERROR"/>
      <appender-ref ref="RollingFileAppender"/>
    </logger>
  </log4net>
  <!--
    有关 .NET 4.5 的 web.config 更改的说明，请参见 http://go.microsoft.com/fwlink/?LinkId=235367。

    可在 <httpRuntime> 标记上设置以下特性。
      <system.Web>
        <httpRuntime targetFramework="4.5" />
      </system.Web>
  -->
  <system.web>
    <compilation debug="true" targetFramework="4.5"/>
    <httpRuntime targetFramework="4.5"/>
    <pages controlRenderingCompatibilityVersion="4.0"/>
  </system.web>
  <system.serviceModel>
    <behaviors>
      <serviceBehaviors>
        <behavior>
          <!-- To avoid disclosing metadata information, set the value below to false and remove the metadata endpoint above before deployment -->
          <serviceMetadata httpGetEnabled="true"/>
          <!-- To receive exception details in faults for debugging purposes, set the value below to true.  Set to false before deployment to avoid disclosing exception information -->
          <serviceDebug includeExceptionDetailInFaults="true"/>
        </behavior>
      </serviceBehaviors>
    </behaviors>
    <serviceHostingEnvironment aspNetCompatibilityEnabled="true" multipleSiteBindingsEnabled="true"/>
  </system.serviceModel>
  <system.webServer>
    <modules runAllManagedModulesForAllRequests="true"/>
  </system.webServer>
</configuration>